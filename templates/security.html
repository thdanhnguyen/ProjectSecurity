{% extends "base.html" %}

{% block title %}B·∫£o M·∫≠t - Secure Auth System{% endblock %}

{% block content %}
<div class="dashboard-page">
    <nav class="navbar">
        <div class="container">
            <div class="navbar-brand">
                <h2>üîê Secure Auth</h2>
            </div>
            <div class="navbar-menu">
                <a href="{{ url_for('dashboard') }}" class="nav-link">Dashboard</a>
                <a href="{{ url_for('profile') }}" class="nav-link">H·ªì S∆°</a>
                <a href="{{ url_for('security') }}" class="nav-link active">B·∫£o M·∫≠t</a>
                <a href="{{ url_for('logout') }}" class="nav-link">ƒêƒÉng Xu·∫•t</a>
            </div>
        </div>
    </nav>

    <div class="container dashboard-content">
        <h1>C√†i ƒê·∫∑t B·∫£o M·∫≠t</h1>

        <div class="security-section">
            <div class="security-card">
                <h3>üîë ƒê·ªïi M·∫≠t Kh·∫©u</h3>
                <form method="POST" action="{{ url_for('change_password') }}" class="security-form">
                    <div class="form-group">
                        <label for="current_password">M·∫≠t kh·∫©u hi·ªán t·∫°i</label>
                        <input type="password" id="current_password" name="current_password" required>
                    </div>

                    <div class="form-group">
                        <label for="new_password">M·∫≠t kh·∫©u m·ªõi</label>
                        <input type="password" id="new_password" name="new_password" required>
                    </div>

                    <div class="form-group">
                        <label for="confirm_password">X√°c nh·∫≠n m·∫≠t kh·∫©u m·ªõi</label>
                        <input type="password" id="confirm_password" name="confirm_password" required>
                    </div>

                    <button type="submit" class="btn btn-primary">ƒê·ªïi M·∫≠t Kh·∫©u</button>
                </form>
            </div>

            <div class="security-card">
                <h3>üîê Th√¥ng Tin M·∫≠t Kh·∫©u BƒÉm</h3>
                <p>M·∫≠t kh·∫©u c·ªßa b·∫°n ƒë∆∞·ª£c l∆∞u tr·ªØ d∆∞·ªõi d·∫°ng bƒÉm:</p>
                
                <div class="hash-info">
                    <div class="hash-item">
                        <strong>Bcrypt (Ch√≠nh):</strong>
                        <code class="hash-code">{{ user.password_hash[:50] }}...</code>
                        <span class="hash-badge">An to√†n nh·∫•t</span>
                    </div>
                    
                    <div class="hash-item">
                        <strong>SHA-256:</strong>
                        <code class="hash-code">{{ user.password_sha256[:50] }}...</code>
                        <span class="hash-badge">256-bit</span>
                    </div>
                    
                    <div class="hash-item">
                        <strong>MD5 (Legacy):</strong>
                        <code class="hash-code">{{ user.password_md5 }}</code>
                        <span class="hash-badge hash-badge-warning">Kh√¥ng an to√†n</span>
                    </div>
                </div>

                <div class="security-note">
                    <strong>‚ö†Ô∏è L∆∞u √Ω:</strong> MD5 ch·ªâ ƒë∆∞·ª£c l∆∞u ƒë·ªÉ demo. Trong th·ª±c t·∫ø, ch·ªâ n√™n d√πng Bcrypt ho·∫∑c Argon2.
                </div>
            </div>

            <div class="security-card">
                <h3>üì± X√°c Th·ª±c 2 L·ªõp (2FA)</h3>
                <p>H·ªá th·ªëng ƒëang s·ª≠ d·ª•ng OTP qua email</p>
                <div class="security-status">
                    <span class="status-icon">‚úÖ</span>
                    <span class="status-text">ƒê√£ k√≠ch ho·∫°t</span>
                </div>
                <ul class="security-list">
                    <li>M√£ OTP 6 ch·ªØ s·ªë</li>
                    <li>G·ª≠i qua email: {{ user.email }}</li>
                    <li>C√≥ hi·ªáu l·ª±c 5 ph√∫t</li>
                    <li>B·∫Øt bu·ªôc khi ƒëƒÉng nh·∫≠p</li>
                </ul>
            </div>
        </div>
    </div>
</div>
{% endblock %}
